[gd_scene load_steps=5 format=2]

[ext_resource path="res://scenes/Game/Bar/SimpleBar.gd" type="Script" id=1]

[sub_resource type="QuadMesh" id=9]
size = Vector2( 1.4, 0.2 )

[sub_resource type="Shader" id=8]
code = "shader_type spatial;
render_mode unshaded, depth_test_disable;

uniform float percentage : hint_range(0, 1);
uniform vec4 barColor : hint_color;
uniform vec4 backgroundColor: hint_color;
uniform vec2 barSize;

void vertex() {
	MODELVIEW_MATRIX = INV_CAMERA_MATRIX * mat4(CAMERA_MATRIX[0],CAMERA_MATRIX[1],CAMERA_MATRIX[2],WORLD_MATRIX[3]);
}

void fragment() {
	float xCorr = barSize.y / barSize.x;
	vec2 uv = UV;
	float corXMin = 0.1  * xCorr;
	float corXMax = 1.0 - 0.1  * xCorr;
	bool isBorder = uv.x < corXMin || uv.x > corXMax || uv.y < 0.1 || uv.y > 0.9;
	if(isBorder) {
		ALBEDO = vec3(0, 0, 0);
	} else {
		if(uv.x < percentage) {
			ALBEDO = barColor.rgb;
		} else {
			ALBEDO = backgroundColor.rgb;
		}
	}
}
"

[sub_resource type="ShaderMaterial" id=10]
resource_local_to_scene = true
shader = SubResource( 8 )
shader_param/percentage = 1.0
shader_param/barColor = Color( 0.854902, 0.0117647, 0.0117647, 1 )
shader_param/backgroundColor = Color( 0.32549, 0.32549, 0.32549, 1 )
shader_param/barSize = Vector2( 1.4, 0.2 )

[node name="SimpleBar" type="Spatial"]
script = ExtResource( 1 )

[node name="BarMesh" type="MeshInstance" parent="."]
mesh = SubResource( 9 )
material/0 = SubResource( 10 )
